{% extends "layout.html" %}
{% block content %}

<div class = "page" style = "background: #fff">
    <div class = "page-main">
        <div class = "header py-4", style="height: 64px;">
            <header class="header">
            <a href='/' style="text-align: left;">
              <img src="/static/images/transparent.svg" class="header-brand-img mr-2" alt="Responsly Logo", style="padding: 15px; height:100%;">
            </a>
          </header>
        </div>

    <div class = "container mt-5">
        <div id="recommendation_holder">
          <h3 id = 'output-recommendation' class = 'heading'> Recommendations </h3>
          <div id = "underline"> </div>
          <div class="container">
              <div id="carouselContent" class="carousel slide" data-interval="false">
                  <div class="carousel-inner" role="listbox">
                      <div class="carousel-item active text-center p-4" id='recommendation1'>
                           <p id="loadingText">...loading...</p>
                      </div>
                      <div class="carousel-item text-center p-4" id='recommendation2'>
                      </div>
                      <div class="carousel-item text-center p-4" id='recommendation3'>
                      </div>
                  </div>
                  <a class="carousel-control-prev" href="#carouselContent" role="button" data-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="sr-only">Previous</span>
                  </a>
                  <a class="carousel-control-next" href="#carouselContent" role="button" data-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                  </a>
              </div>
          </div>
        </div>
      </div>

      <div class = "container" style = "display: block; text-align:center;"> 
          <form action="/chat">
              <input id ='back_to_chat' class="btn btn-primary" value="Back to New Chat" type="submit"/>
          </form>
        </div> 


      

      <script type="text/javascript">
        var socket = io.connect('http://' + document.domain + ':' + location.port + '/test');

        window.onload = function() {
          console.log('Page Load Function Called');

          socket.emit('recommendation_python', namespace='/test');
        };


      socket.on('recommendation_socket', function(msg) {
        ////Add response image to your message on the right
        recommendations_array = msg.recommendations_array
        var myobj = document.getElementById("loadingText");
        myobj.remove();
      
        for (let l = 0; l < recommendations_array.length; l++) {
        // Runs 5 times, with values of step 0 through 4.
        var recommendation_body = document.createElement("p");
        recommendation_body.style = "padding: 0px 100px;"
        recommendation_body.innerHTML = recommendations_array[l]

        console.log('recommendation' + (l+1));

        document.getElementById('recommendation' + (l+1)).appendChild(recommendation_body);
      
      }
    })
      </script> 

{% endblock content %}